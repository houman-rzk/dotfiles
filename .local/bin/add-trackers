#!/bin/sh

[ $# -ne 1 ] && echo "ERROR: Wrong argument count (there should be only one)" && exit 1

ping -c 1 1.1.1.1 >/dev/null 2>&1|| ping -c 1 9.9.9.9 >/dev/null 2>&1 || { echo "ERROR: No internet connection. Trackers were not added." && exit 1 ;}

trackers_before="$(transmission-remote -t "$1" -it | grep -c "Tracker [0-9][0-9]*")"

curl -s https://raw.githubusercontent.com/ngosang/trackerslist/master/trackers_all_https.txt | while read -r tracker ; do [ "$tracker" = "" ] || transmission-remote -t "$1" -td "$tracker" >/dev/null 2>&1 ; done

trackers_after="$(transmission-remote -t "$1" -it | grep -c "Tracker [0-9][0-9]*")"

{ [ "$trackers_before" -ne "$trackers_after" ] && echo "DONE: Trackers added successfully." ;} || echo "ERROR: Trackers were not added."
